"use strict";(self.webpackChunkMovieMatch=self.webpackChunkMovieMatch||[]).push([[795],{8795:(Je,S,p)=>{p.r(S),p.d(S,{DEFAULT_IDENTITY_CREATE_FORM_PROPS:()=>j,DEFAULT_IDENTITY_EDIT_FORM_PROPS:()=>Q,DEFAULT_IDENTITY_ENTITY_ACTIONS:()=>B,DEFAULT_IDENTITY_ENTITY_PROPS:()=>J,DEFAULT_IDENTITY_TOOLBAR_ACTIONS:()=>w,IDENTITY_CREATE_FORM_PROP_CONTRIBUTORS:()=>x,IDENTITY_EDIT_FORM_PROP_CONTRIBUTORS:()=>M,IDENTITY_ENTITY_ACTION_CONTRIBUTORS:()=>C,IDENTITY_ENTITY_PROP_CONTRIBUTORS:()=>O,IDENTITY_TOOLBAR_ACTION_CONTRIBUTORS:()=>A,IdentityExtensionsGuard:()=>R,IdentityModule:()=>we,RolesComponent:()=>h,UsersComponent:()=>g});var r=p(8609),m=p(1765),l=p(4508),e=p(6435),T=p(537),I=p(2994),P=p(7545),z=p(4850),V=p(7604);let K=(()=>{class i{constructor(t){this.restService=t,this.apiName="AbpIdentity",this.create=n=>this.restService.request({method:"POST",url:"/api/identity/roles",body:n},{apiName:this.apiName}),this.delete=n=>this.restService.request({method:"DELETE",url:`/api/identity/roles/${n}`},{apiName:this.apiName}),this.get=n=>this.restService.request({method:"GET",url:`/api/identity/roles/${n}`},{apiName:this.apiName}),this.getAllList=()=>this.restService.request({method:"GET",url:"/api/identity/roles/all"},{apiName:this.apiName}),this.getList=n=>this.restService.request({method:"GET",url:"/api/identity/roles",params:{filter:n.filter,sorting:n.sorting,skipCount:n.skipCount,maxResultCount:n.maxResultCount}},{apiName:this.apiName}),this.update=(n,s)=>this.restService.request({method:"PUT",url:`/api/identity/roles/${n}`,body:s},{apiName:this.apiName})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(r.vgb))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),$=(()=>{class i{constructor(t){this.restService=t,this.apiName="AbpIdentity",this.create=n=>this.restService.request({method:"POST",url:"/api/identity/users",body:n},{apiName:this.apiName}),this.delete=n=>this.restService.request({method:"DELETE",url:`/api/identity/users/${n}`},{apiName:this.apiName}),this.findByEmail=n=>this.restService.request({method:"GET",url:`/api/identity/users/by-email/${n}`},{apiName:this.apiName}),this.findByUsername=n=>this.restService.request({method:"GET",url:`/api/identity/users/by-username/${n}`},{apiName:this.apiName}),this.get=n=>this.restService.request({method:"GET",url:`/api/identity/users/${n}`},{apiName:this.apiName}),this.getAssignableRoles=()=>this.restService.request({method:"GET",url:"/api/identity/users/assignable-roles"},{apiName:this.apiName}),this.getList=n=>this.restService.request({method:"GET",url:"/api/identity/users",params:{filter:n.filter,sorting:n.sorting,skipCount:n.skipCount,maxResultCount:n.maxResultCount}},{apiName:this.apiName}),this.getRoles=n=>this.restService.request({method:"GET",url:`/api/identity/users/${n}/roles`},{apiName:this.apiName}),this.update=(n,s)=>this.restService.request({method:"PUT",url:`/api/identity/users/${n}`,body:s},{apiName:this.apiName}),this.updateRoles=(n,s)=>this.restService.request({method:"PUT",url:`/api/identity/users/${n}/roles`,body:s},{apiName:this.apiName})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(r.vgb))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var H=p(1221),N=p(1086),W=p(2986);let X=(()=>{class i{constructor(t){this.restService=t,this.apiName="AbpPermissionManagement",this.get=(n,s)=>this.restService.request({method:"GET",url:"/api/permission-management/permissions",params:{providerName:n,providerKey:s}},{apiName:this.apiName}),this.update=(n,s,a)=>this.restService.request({method:"PUT",url:"/api/permission-management/permissions",params:{providerName:n,providerKey:s},body:a},{apiName:this.apiName})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(r.vgb))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var y=p(9808),c=p(4182);const ee=["selectAllInThisTabsRef"],te=["selectAllInAllTabsRef"];function ie(i,o){if(1&i&&(e.TgZ(0,"h4"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"AbpPermissionManagement::Permissions")," - ",t.entityDisplayName||t.data.entityDisplayName," ")}}function ne(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"a",24),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3).onChangeGroup(s)}),e.TgZ(1,"div"),e._uU(2),e.TgZ(3,"span"),e._uU(4),e.qZA()()()}if(2&i){const t=o.ngIf,n=e.oxw().$implicit,s=e.oxw(3);e.ekj("active",(null==s.selectedGroup?null:s.selectedGroup.name)===(null==n?null:n.name)),e.xp6(1),e.ekj("font-weight-bold",t.assignedCount),e.xp6(1),e.hij(" ",null==n?null:n.displayName," "),e.xp6(2),e.hij("(",t.assignedCount,")")}}const se=function(i){return{assignedCount:i}};function oe(i,o){if(1&i&&(e.TgZ(0,"li",22),e.YNc(1,ne,5,6,"a",23),e.qZA()),2&i){const t=o.$implicit,n=e.oxw(3);e.xp6(1),e.Q6J("ngIf",e.VKq(1,se,n.getAssignedCount(t.name)))}}function ae(i,o){if(1&i&&(e.TgZ(0,"span",30),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.xp6(1),e.AsE("",t.providerName,": ",t.providerKey,"")}}function re(i,o){if(1&i&&(e.ynx(0),e.YNc(1,ae,2,2,"span",29),e.BQk()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.grantedProviders)}}function le(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",25)(1,"input",26,27),e.NdJ("click",function(){const a=e.CHM(t).$implicit,d=e.MAs(2);return e.oxw(3).onClickCheckbox(a,d.value)}),e.qZA(),e.TgZ(3,"label",28),e._uU(4),e.YNc(5,re,2,1,"ng-container",1),e.qZA()()}if(2&i){const t=o.$implicit,n=e.oxw(3);e.Q6J("ngStyle",t.style),e.xp6(1),e.Q6J("checked",n.getChecked(t.name))("value",n.getChecked(t.name))("disabled",n.isGrantedByOtherProviderName(t.grantedProviders)),e.uIk("id",t.name),e.xp6(2),e.uIk("for",t.name),e.xp6(1),e.hij("",t.displayName," "),e.xp6(1),e.Q6J("ngIf",!n.hideBadges)}}function ce(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",5)(1,"input",6,7),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).selectAllTab=s})("click",function(){return e.CHM(t),e.oxw(2).onClickSelectAll()}),e.qZA(),e.TgZ(3,"label",8),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()(),e._UZ(6,"hr",9),e.TgZ(7,"div",10)(8,"div",11)(9,"ul",12),e.YNc(10,oe,2,3,"li",13),e.qZA()(),e.TgZ(11,"div",14)(12,"h4"),e._uU(13),e.qZA(),e._UZ(14,"hr",15),e.TgZ(15,"div",16)(16,"div",5)(17,"input",17,18),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).selectThisTab=s})("click",function(){return e.CHM(t),e.oxw(2).onClickSelectThisTab()}),e.qZA(),e.TgZ(19,"label",19),e._uU(20),e.ALo(21,"abpLocalization"),e.qZA()(),e._UZ(22,"hr",20),e.YNc(23,le,6,8,"div",21),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngModel",t.selectAllTab),e.xp6(3),e.Oqu(e.lcZ(5,9,"AbpPermissionManagement::SelectAllInAllTabs")),e.xp6(6),e.Q6J("ngForOf",t.data.groups)("ngForTrackBy",t.trackByFn),e.xp6(3),e.Oqu(null==t.selectedGroup?null:t.selectedGroup.displayName),e.xp6(4),e.Q6J("ngModel",t.selectThisTab),e.xp6(3),e.Oqu(e.lcZ(21,11,"AbpPermissionManagement::SelectAllInThisTab")),e.xp6(3),e.Q6J("ngForOf",t.selectedGroupPermissions)("ngForTrackBy",t.trackByFn)}}function pe(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",32),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).submit()}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,2,"AbpIdentity::Cancel")," "),e.xp6(3),e.Oqu(e.lcZ(5,4,"AbpIdentity::Save")))}function me(i,o){1&i&&(e.ynx(0),e.YNc(1,ie,3,4,"ng-template",null,2,e.W1O),e.YNc(3,ce,24,13,"ng-template",null,3,e.W1O),e.YNc(5,pe,6,6,"ng-template",null,4,e.W1O),e.BQk())}const de=function(){return{size:"lg"}};let E=(()=>{class i{constructor(t,n){this.service=t,this.configState=n,this.hideBadges=!1,this._visible=!1,this.visibleChange=new e.vpe,this.data={groups:[],entityDisplayName:null},this.permissions=[],this.selectThisTab=!1,this.selectAllTab=!1,this.modalBusy=!1,this.trackByFn=(s,a)=>a.name}get visible(){return this._visible}set visible(t){t!==this._visible&&(t?this.openModal().subscribe(()=>{this._visible=!0,this.visibleChange.emit(!0),(0,H.z)(this.selectAllInAllTabsRef.changes,this.selectAllInThisTabsRef.changes).pipe((0,W.q)(1)).subscribe(()=>{this.initModal()})}):(this.selectedGroup=null,this._visible=!1,this.visibleChange.emit(!1)))}get selectedGroupPermissions(){if(!this.selectedGroup)return[];const t=`margin-${"rtl"===document.body.dir?"right":"left"}.px`,n=this.data.groups.find(s=>s.name===this.selectedGroup.name).permissions;return n.map(s=>Object.assign(Object.assign({},s),{style:{[t]:U(n,s)},isGranted:this.permissions.find(a=>a.name===s.name).isGranted}))}getChecked(t){return(this.permissions.find(n=>n.name===t)||{isGranted:!1}).isGranted}isGrantedByOtherProviderName(t){return!!t.length&&t.findIndex(n=>n.providerName!==this.providerName)>-1}onClickCheckbox(t,n){t.isGranted&&this.isGrantedByOtherProviderName(t.grantedProviders)||setTimeout(()=>{this.permissions=this.permissions.map(s=>t.name===s.name?Object.assign(Object.assign({},s),{isGranted:!s.isGranted}):t.name===s.parentName&&t.isGranted?Object.assign(Object.assign({},s),{isGranted:!1}):t.parentName!==s.name||t.isGranted?s:Object.assign(Object.assign({},s),{isGranted:!0})),this.setTabCheckboxState(),this.setGrantCheckboxState()},0)}setTabCheckboxState(){const t=this.selectedGroupPermissions.filter(s=>s.isGranted),n=document.querySelector("#select-all-in-this-tabs");t.length===this.selectedGroupPermissions.length?(n.indeterminate=!1,this.selectThisTab=!0):0===t.length?(n.indeterminate=!1,this.selectThisTab=!1):n.indeterminate=!0}setGrantCheckboxState(){const t=this.permissions.filter(s=>s.isGranted),n=document.querySelector("#select-all-in-all-tabs");t.length===this.permissions.length?(n.indeterminate=!1,this.selectAllTab=!0):0===t.length?(n.indeterminate=!1,this.selectAllTab=!1):n.indeterminate=!0}onClickSelectThisTab(){this.selectedGroupPermissions.forEach(t=>{if(t.isGranted&&this.isGrantedByOtherProviderName(t.grantedProviders))return;const n=this.permissions.findIndex(s=>s.name===t.name);this.permissions=[...this.permissions.slice(0,n),Object.assign(Object.assign({},this.permissions[n]),{isGranted:!this.selectThisTab}),...this.permissions.slice(n+1)]}),this.setGrantCheckboxState()}onClickSelectAll(){this.permissions=this.permissions.map(t=>Object.assign(Object.assign({},t),{isGranted:this.isGrantedByOtherProviderName(t.grantedProviders)||!this.selectAllTab})),this.selectThisTab=!this.selectAllTab}onChangeGroup(t){this.selectedGroup=t,this.setTabCheckboxState()}submit(){const t=k(this.data.groups),n=this.permissions.filter(s=>t.find(a=>a.name===s.name).isGranted!==s.isGranted).map(({name:s,isGranted:a})=>({name:s,isGranted:a}));n.length?(this.modalBusy=!0,this.service.update(this.providerName,this.providerKey,{permissions:n}).pipe((0,P.w)(()=>this.shouldFetchAppConfig()?this.configState.refreshAppState():(0,N.of)(null)),(0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.visible=!1})):this.visible=!1}openModal(){if(!this.providerKey||!this.providerName)throw new Error("Provider Key and Provider Name are required.");return this.service.get(this.providerName,this.providerKey).pipe((0,I.b)(t=>{this.data=t,this.selectedGroup=t.groups[0],this.permissions=k(t.groups)}))}initModal(){setTimeout(()=>{this.setTabCheckboxState(),this.setGrantCheckboxState()})}getAssignedCount(t){return this.permissions.reduce((n,s)=>s.groupName===t&&s.isGranted?n+1:n,0)}shouldFetchAppConfig(){const t=this.configState.getOne("currentUser");return"R"===this.providerName?t.roles.some(n=>n===this.providerKey):"U"===this.providerName&&t.id===this.providerKey}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(X),e.Y36(r.XJE))},i.\u0275cmp=e.Xpm({type:i,selectors:[["abp-permission-management"]],viewQuery:function(t,n){if(1&t&&(e.Gf(ee,5),e.Gf(te,5)),2&t){let s;e.iGM(s=e.CRH())&&(n.selectAllInThisTabsRef=s),e.iGM(s=e.CRH())&&(n.selectAllInAllTabsRef=s)}},inputs:{providerName:"providerName",providerKey:"providerKey",hideBadges:"hideBadges",entityDisplayName:"entityDisplayName",visible:"visible"},outputs:{visibleChange:"visibleChange"},exportAs:["abpPermissionManagement"],decls:2,vars:5,consts:[[3,"visible","busy","options","visibleChange"],[4,"ngIf"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"form-check","mb-2"],["type","checkbox","id","select-all-in-all-tabs","name","select-all-in-all-tabs",1,"form-check-input",3,"ngModel","ngModelChange","click"],["selectAllInAllTabsRef",""],["for","select-all-in-all-tabs",1,"form-check-label"],[1,"mt-2","mb-2"],[1,"row"],[1,"overflow-scroll","col-md-4"],[1,"nav","nav-pills","flex-column"],["class","nav-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"col-md-8","overflow-scroll"],[1,"mt-2","mb-3"],[1,"ps-1","pt-1"],["type","checkbox","id","select-all-in-this-tabs","name","select-all-in-this-tabs",1,"form-check-input",3,"ngModel","ngModelChange","click"],["selectAllInThisTabsRef",""],["for","select-all-in-this-tabs",1,"form-check-label"],[1,"mb-3"],["class","form-check mb-2",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],[1,"nav-item"],["class","nav-link pointer",3,"active","click",4,"ngIf"],[1,"nav-link","pointer",3,"click"],[1,"form-check","mb-2",3,"ngStyle"],["type","checkbox",1,"form-check-input",3,"checked","value","disabled","click"],["permissionCheckbox",""],[1,"form-check-label"],["class","badge bg-light text-dark",4,"ngFor","ngForOf"],[1,"badge","bg-light","text-dark"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"abp-modal",0),e.NdJ("visibleChange",function(a){return n.visible=a}),e.YNc(1,me,7,0,"ng-container",1),e.qZA()),2&t&&(e.Q6J("visible",n.visible)("busy",n.modalBusy)("options",e.DdM(4,de)),e.xp6(1),e.Q6J("ngIf",n.data.entityDisplayName||n.entityDisplayName))},directives:[m.zS,m.r0,y.O5,c.Wl,c.JJ,c.On,y.sg,y.PC,m.YM],pipes:[r.fuE],styles:[".overflow-scroll[_ngcontent-%COMP%]{max-height:70vh;overflow-y:scroll}"]}),i})();function U(i,o){const t=i.find(n=>n.name===o.parentName);if(t&&t.parentName){let n=20;return n+=U(i,t)}return t?20:0}function k(i){return i.reduce((o,t)=>[...o,...t.permissions.map(n=>Object.assign(Object.assign({},n),{groupName:t.name}))],[])}let ue=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[r.IR2,m.e2]]}),i})();var v=p(3951),_=p(2537),D=p(1771);function _e(i,o){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,null!=t.selected&&t.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewRole"))}}function he(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"form",14),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw().save()}),e._UZ(1,"abp-extensible-form",15),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("selectedRecord",t.selected)}}function ge(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",16),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",17),e.NdJ("click",function(){return e.CHM(t),e.oxw().save()}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpIdentity::Cancel")," "),e.xp6(2),e.Q6J("disabled",null==t.form?null:t.form.invalid),e.xp6(1),e.Oqu(e.lcZ(5,5,"AbpIdentity::Save"))}}function be(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"abp-permission-management",18,19),e.NdJ("abpInit",function(){return(0,e.CHM(t).initTemplate)(e.MAs(1))}),e.qZA()}}const fe=function(){return{value:"R"}},Z=function(i){return{value:i}},F=function(i){return{value:i,twoWay:!0}},ye=function(){return{value:!0}},ve=function(i,o,t,n){return{providerName:i,providerKey:o,visible:t,hideBadges:n}},L=function(i){return{visibleChange:i}},Y=function(i,o,t){return{inputs:i,outputs:o,componentKey:t}},Te=["modalContent"];function Ie(i,o){if(1&i&&(e.TgZ(0,"h3"),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,null!=t.selected&&t.selected.id?"AbpIdentity::Edit":"AbpIdentity::NewUser"))}}function Ne(i,o){1&i&&(e.TgZ(0,"div",19),e._UZ(1,"i",20),e.qZA())}function Ce(i,o){if(1&i&&e._UZ(0,"abp-extensible-form",28),2&i){const t=e.oxw(3);e.Q6J("selectedRecord",t.selected)}}function Ae(i,o){if(1&i&&(e.TgZ(0,"div",30),e._UZ(1,"input",31),e.TgZ(2,"label",32),e._uU(3),e.qZA()()),2&i){const t=o.$implicit,n=o.index,s=e.oxw(4);e.xp6(1),e.Q6J("formControl",t.controls[s.roles[n].name]),e.uIk("id","roles-"+n),e.xp6(1),e.uIk("for","roles-"+n),e.xp6(1),e.Oqu(s.roles[n].name)}}function Oe(i,o){if(1&i&&e.YNc(0,Ae,4,4,"div",29),2&i){const t=e.oxw(3);e.Q6J("ngForOf",t.roleGroups)("ngForTrackBy",t.trackByFn)}}function xe(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"form",21),e.NdJ("ngSubmit",function(){return e.CHM(t),e.oxw(2).save()}),e.TgZ(1,"ul",22,23)(3,"li",24)(4,"a",25),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA(),e.YNc(7,Ce,1,1,"ng-template",26),e.qZA(),e.TgZ(8,"li",24)(9,"a",25),e._uU(10),e.ALo(11,"abpLocalization"),e.qZA(),e.YNc(12,Oe,1,2,"ng-template",26),e.qZA()(),e._UZ(13,"div",27),e.qZA()}if(2&i){const t=e.MAs(2),n=e.oxw(2);e.Q6J("formGroup",n.form),e.xp6(5),e.Oqu(e.lcZ(6,4,"AbpIdentity::UserInformations")),e.xp6(5),e.Oqu(e.lcZ(11,6,"AbpIdentity::Roles")),e.xp6(3),e.Q6J("ngbNavOutlet",t)}}function Me(i,o){if(1&i&&(e.YNc(0,Ne,2,0,"ng-template",null,17,e.W1O),e.YNc(2,xe,14,8,"form",18)),2&i){const t=e.MAs(1),n=e.oxw();e.xp6(2),e.Q6J("ngIf",n.form)("ngIfElse",t)}}function Re(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"button",33),e._uU(1),e.ALo(2,"abpLocalization"),e.qZA(),e.TgZ(3,"abp-button",34),e.NdJ("click",function(){return e.CHM(t),e.oxw().save()}),e._uU(4),e.ALo(5,"abpLocalization"),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,3,"AbpIdentity::Cancel")," "),e.xp6(2),e.Q6J("disabled",null==t.form?null:t.form.invalid),e.xp6(1),e.Oqu(e.lcZ(5,5,"AbpIdentity::Save"))}}function Se(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"abp-permission-management",35,36),e.NdJ("abpInit",function(){return(0,e.CHM(t).initTemplate)(e.MAs(1))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("entityDisplayName",t.entityDisplayName)}}const Pe=function(){return{value:"U"}},Ee=function(i,o,t){return{providerName:i,providerKey:o,visible:t}};let h=(()=>{class i{constructor(t,n,s,a,d){this.list=t,this.confirmationService=n,this.toasterService=s,this.injector=a,this.service=d,this.data={items:[],totalCount:0},this.visiblePermissions=!1,this.modalBusy=!1,this.permissionManagementKey="PermissionManagement.PermissionManagementComponent",this.onVisiblePermissionChange=b=>{this.visiblePermissions=b}}ngOnInit(){this.hookToQuery()}buildForm(){const t=new l.lg(this.injector,this.selected);this.form=(0,l.se)(t)}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.openModal()}edit(t){this.service.get(t).subscribe(n=>{this.selected=n,this.openModal()})}save(){if(!this.form.valid)return;this.modalBusy=!0;const{id:t}=this.selected;(t?this.service.update(t,Object.assign(Object.assign({},this.selected),this.form.value)):this.service.create(this.form.value)).pipe((0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}delete(t,n){this.confirmationService.warn("AbpIdentity::RoleDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[n]}).subscribe(s=>{s===m.Tv.Status.confirm&&(this.toasterService.success("AbpUi::SuccessfullyDeleted"),this.service.delete(t).subscribe(()=>this.list.get()))})}hookToQuery(){this.list.hookToQuery(t=>this.service.getList(t)).subscribe(t=>this.data=t)}openPermissionsModal(t){this.providerKey=t,setTimeout(()=>{this.visiblePermissions=!0},0)}sort(t){const{prop:n,dir:s}=t.sorts[0];this.list.sortKey=n,this.list.sortOrder=s}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.XNV),e.Y36(m.YP),e.Y36(m.MJ),e.Y36(e.zs3),e.Y36(K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["abp-roles"]],features:[e._Bn([r.XNV,{provide:l.ex,useValue:"Identity.RolesComponent"}])],decls:19,vars:27,consts:[["id","identity-roles-wrapper",1,"card"],[1,"card-header"],[1,"row"],[1,"col","col-md-6"],[1,"card-title"],[1,"text-end","col","col-md-6"],[3,"record"],[1,"card-body"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"abpInit",4,"abpReplaceableTemplate"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[3,"selectedRecord"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"disabled","click"],[3,"abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"abp-page-toolbar",6),e.qZA()()(),e.TgZ(9,"div",7),e._UZ(10,"abp-extensible-table",8),e.qZA()(),e.TgZ(11,"abp-modal",9),e.NdJ("visibleChange",function(a){return n.isModalVisible=a}),e.YNc(12,_e,3,3,"ng-template",null,10,e.W1O),e.YNc(14,he,2,2,"ng-template",null,11,e.W1O),e.YNc(16,ge,6,7,"ng-template",null,12,e.W1O),e.qZA(),e.YNc(18,be,2,0,"abp-permission-management",13)),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,8,"AbpIdentity::Roles")),e.xp6(3),e.Q6J("record",n.data.items),e.xp6(2),e.Q6J("data",n.data.items)("recordsTotal",n.data.totalCount)("list",n.list),e.xp6(1),e.Q6J("visible",n.isModalVisible)("busy",n.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.kEZ(23,Y,e.l5B(16,ve,e.DdM(10,fe),e.VKq(11,Z,n.providerKey),e.VKq(13,F,n.visiblePermissions),e.DdM(15,ye)),e.VKq(21,L,n.onVisiblePermissionChange),n.permissionManagementKey)))},directives:[l._V,l.m5,m.zS,l.gt,m.r0,E,c._Y,c.JL,r.YzZ,c.sg,v.hL,m.YM,r.zLP,r.Ngh],pipes:[r.fuE],encapsulation:2}),i})(),g=(()=>{class i{constructor(t,n,s,a,d,b){this.list=t,this.confirmationService=n,this.service=s,this.toasterService=a,this.fb=d,this.injector=b,this.data={items:[],totalCount:0},this.visiblePermissions=!1,this.modalBusy=!1,this.permissionManagementKey="PermissionManagement.PermissionManagementComponent",this.trackByFn=(f,u)=>Object.keys(u)[0]||f,this.onVisiblePermissionChange=f=>{this.visiblePermissions=f}}get roleGroups(){var t;return(null===(t=this.form.get("roleNames"))||void 0===t?void 0:t.controls)||[]}ngOnInit(){this.hookToQuery()}buildForm(){const t=new l.lg(this.injector,this.selected);this.form=(0,l.se)(t),this.service.getAssignableRoles().subscribe(({items:n})=>{this.roles=n,this.form.addControl("roleNames",this.fb.array(this.roles.map(s=>{var a;return this.fb.group({[s.name]:[this.selected.id?!!(null===(a=this.selectedUserRoles)||void 0===a?void 0:a.find(d=>d.id===s.id)):s.isDefault]})})))})}openModal(){this.buildForm(),this.isModalVisible=!0}add(){this.selected={},this.selectedUserRoles=[],this.openModal()}edit(t){this.service.get(t).pipe((0,I.b)(n=>this.selected=n),(0,P.w)(()=>this.service.getRoles(t))).subscribe(n=>{this.selectedUserRoles=n.items||[],this.openModal()})}save(){if(!this.form.valid||this.modalBusy)return;this.modalBusy=!0;const{roleNames:t=[]}=this.form.value,n=t.filter(a=>!!a[Object.keys(a)[0]]).map(a=>Object.keys(a)[0])||[],{id:s}=this.selected;(s?this.service.update(s,Object.assign(Object.assign(Object.assign({},this.selected),this.form.value),{roleNames:n})):this.service.create(Object.assign(Object.assign({},this.form.value),{roleNames:n}))).pipe((0,T.x)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1,this.list.get()})}delete(t,n){this.confirmationService.warn("AbpIdentity::UserDeletionConfirmationMessage","AbpIdentity::AreYouSure",{messageLocalizationParams:[n]}).subscribe(s=>{s===m.Tv.Status.confirm&&this.service.delete(t).subscribe(()=>{this.toasterService.success("AbpUi::SuccessfullyDeleted"),this.list.get()})})}sort(t){const{prop:n,dir:s}=t.sorts[0];this.list.sortKey=n,this.list.sortOrder=s}hookToQuery(){this.list.hookToQuery(t=>this.service.getList(t)).subscribe(t=>this.data=t)}openPermissionsModal(t,n){this.providerKey=t,this.entityDisplayName=n,setTimeout(()=>{this.visiblePermissions=!0},0)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.XNV),e.Y36(m.YP),e.Y36($),e.Y36(m.MJ),e.Y36(c.qu),e.Y36(e.zs3))},i.\u0275cmp=e.Xpm({type:i,selectors:[["abp-users"]],viewQuery:function(t,n){if(1&t&&e.Gf(Te,5),2&t){let s;e.iGM(s=e.CRH())&&(n.modalContent=s.first)}},features:[e._Bn([r.XNV,{provide:l.ex,useValue:"Identity.UsersComponent"}])],decls:23,vars:29,consts:[["id","identity-roles-wrapper",1,"card"],[1,"card-header"],[1,"row"],[1,"col","col-md-6"],[1,"card-title"],[1,"text-end","col","col-md-6"],[3,"record"],[1,"card-body"],["id","data-tables-table-filter",1,"data-tables-filter"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[3,"data","recordsTotal","list"],[3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[3,"entityDisplayName","abpInit",4,"abpReplaceableTemplate"],["loaderRef",""],[3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[1,"text-center"],[1,"fa","fa-pulse","fa-spinner"],[3,"formGroup","ngSubmit"],["ngbNav","",1,"nav-tabs"],["nav","ngbNav"],["ngbNavItem",""],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2","fade-in-top",3,"ngbNavOutlet"],[3,"selectedRecord"],["class","form-check mb-2",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form-check","mb-2"],["type","checkbox",1,"form-check-input",3,"formControl"],[1,"form-check-label"],["type","button","abpClose","",1,"btn","btn-secondary"],["iconClass","fa fa-check",3,"disabled","click"],[3,"entityDisplayName","abpInit"],["abpPermissionManagement","abpPermissionManagement"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),e._uU(5),e.ALo(6,"abpLocalization"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"abp-page-toolbar",6),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"input",10),e.NdJ("ngModelChange",function(a){return n.list.filter=a}),e.ALo(13,"abpLocalization"),e.qZA()()(),e._UZ(14,"abp-extensible-table",11),e.qZA()(),e.TgZ(15,"abp-modal",12),e.NdJ("visibleChange",function(a){return n.isModalVisible=a}),e.YNc(16,Ie,3,3,"ng-template",null,13,e.W1O),e.YNc(18,Me,3,2,"ng-template",null,14,e.W1O),e.YNc(20,Re,6,7,"ng-template",null,15,e.W1O),e.qZA(),e.YNc(22,Se,2,1,"abp-permission-management",16)),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,10,"AbpIdentity::Users")),e.xp6(3),e.Q6J("record",n.data.items),e.xp6(4),e.Q6J("placeholder",e.lcZ(13,12,"AbpUi::PagerSearch"))("ngModel",n.list.filter),e.xp6(2),e.Q6J("data",n.data.items)("recordsTotal",n.data.totalCount)("list",n.list),e.xp6(1),e.Q6J("visible",n.isModalVisible)("busy",n.modalBusy),e.xp6(7),e.Q6J("abpReplaceableTemplate",e.kEZ(25,Y,e.kEZ(19,Ee,e.DdM(14,Pe),e.VKq(15,Z,n.providerKey),e.VKq(17,F,n.visiblePermissions)),e.VKq(23,L,n.onVisiblePermissionChange),n.permissionManagementKey)))},directives:[l._V,l.m5,m.zS,l.gt,_.tO,m.r0,E,c.Fj,c.JJ,c.On,y.O5,c._Y,c.JL,r.YzZ,c.sg,v.hL,_.Pz,_.nv,_.Vx,_.uN,y.sg,c.Wl,c.oH,v.J5,m.YM,r.zLP,r.Ngh],pipes:[r.fuE],encapsulation:2}),i})();const Ue=l.uk.createMany([{text:"AbpIdentity::Edit",action:i=>{i.getInjected(h).edit(i.record.id)},permission:"AbpIdentity.Roles.Update"},{text:"AbpIdentity::Permissions",action:i=>{i.getInjected(h).openPermissionsModal(i.record.name)},permission:"AbpIdentity.Roles.ManagePermissions"},{text:"AbpIdentity::Delete",action:i=>{i.getInjected(h).delete(i.record.id,i.record.name)},permission:"AbpIdentity.Roles.Delete",visible:i=>!i.record.isStatic}]),ke=l.QC.createMany([{type:"string",name:"name",displayName:"AbpIdentity::RoleName",sortable:!0,valueResolver:i=>{const o=i.getInjected(r.oQ8),t=o.instant.bind(o),{isDefault:n,isPublic:s,name:a}=i.record;return(0,N.of)((0,r.F04)(a)+(n?`<span class="badge rounded-pill bg-success ms-1">${t("AbpIdentity::DisplayName:IsDefault")}</span>`:"")+(s?`<span class="badge rounded-pill bg-info ms-1">${t("AbpIdentity::DisplayName:IsPublic")}</span>`:""))}}]),G=l.Od.createMany([{type:"string",name:"name",displayName:"AbpIdentity::RoleName",id:"role-name",disabled:i=>i.record&&i.record.isStatic,validators:()=>[c.kI.required]},{type:"boolean",name:"isDefault",displayName:"AbpIdentity::DisplayName:IsDefault",id:"role-is-default",defaultValue:!1},{type:"boolean",name:"isPublic",displayName:"AbpIdentity::DisplayName:IsPublic",id:"role-is-public",defaultValue:!1}]),De=G,Ze=l.JE.createMany([{text:"AbpIdentity::NewRole",action:i=>{i.getInjected(h).add()},permission:"AbpIdentity.Roles.Create",icon:"fa fa-plus"}]),Fe=l.uk.createMany([{text:"AbpIdentity::Edit",action:i=>{i.getInjected(g).edit(i.record.id)},permission:"AbpIdentity.Users.Update"},{text:"AbpIdentity::Permissions",action:i=>{i.getInjected(g).openPermissionsModal(i.record.id,i.record.userName)},permission:"AbpIdentity.Users.ManagePermissions"},{text:"AbpIdentity::Delete",action:i=>{i.getInjected(g).delete(i.record.id,i.record.name||i.record.userName)},permission:"AbpIdentity.Users.Delete"}]),Le=l.QC.createMany([{type:"string",name:"userName",displayName:"AbpIdentity::UserName",sortable:!0,columnWidth:250,valueResolver:i=>{const o=i.getInjected(r.oQ8),n=`<i title="${o.instant.bind(o)("AbpIdentity::ThisUserIsNotActiveMessage")}" class="fas fa-ban text-danger me-1"></i>`;return(0,N.of)(`\n        ${i.record.isActive?"":n}\n        <span class="${i.record.isActive?"":"text-muted"}">${(0,r.F04)(i.record.userName)}</span>`)}},{type:"string",name:"email",displayName:"AbpIdentity::EmailAddress",sortable:!0,columnWidth:250},{type:"string",name:"phoneNumber",displayName:"AbpIdentity::PhoneNumber",sortable:!0,columnWidth:250}]),q=l.Od.createMany([{type:"string",name:"userName",displayName:"AbpIdentity::UserName",id:"user-name",validators:()=>[c.kI.required,c.kI.maxLength(256)]},{type:"password",name:"password",displayName:"AbpIdentity::Password",id:"password",autocomplete:"new-password",validators:i=>[c.kI.required,...(0,m.dD)({get:i.getInjected})]},{type:"string",name:"name",displayName:"AbpIdentity::DisplayName:Name",id:"name",validators:()=>[c.kI.maxLength(64)]},{type:"string",name:"surname",displayName:"AbpIdentity::DisplayName:Surname",id:"surname",validators:()=>[c.kI.maxLength(64)]},{type:"email",name:"email",displayName:"AbpIdentity::EmailAddress",id:"email",validators:()=>[c.kI.required,c.kI.maxLength(256),c.kI.email]},{type:"string",name:"phoneNumber",displayName:"AbpIdentity::PhoneNumber",id:"phone-number",validators:()=>[c.kI.maxLength(16)]},{type:"boolean",name:"isActive",displayName:"AbpIdentity::DisplayName:IsActive",id:"active-checkbox",defaultValue:!0},{type:"boolean",name:"lockoutEnabled",displayName:"AbpIdentity::DisplayName:LockoutEnabled",id:"lockout-checkbox",defaultValue:!0}]),Ye=q.filter(i=>"password"!==i.name),Ge=l.JE.createMany([{text:"AbpIdentity::NewUser",action:i=>{i.getInjected(g).add()},permission:"AbpIdentity.Users.Create",icon:"fa fa-plus"}]),B={"Identity.RolesComponent":Ue,"Identity.UsersComponent":Fe},w={"Identity.RolesComponent":Ze,"Identity.UsersComponent":Ge},J={"Identity.RolesComponent":ke,"Identity.UsersComponent":Le},j={"Identity.RolesComponent":G,"Identity.UsersComponent":q},Q={"Identity.RolesComponent":De,"Identity.UsersComponent":Ye},C=new e.OlP("IDENTITY_ENTITY_ACTION_CONTRIBUTORS"),A=new e.OlP("IDENTITY_TOOLBAR_ACTION_CONTRIBUTORS"),O=new e.OlP("IDENTITY_ENTITY_PROP_CONTRIBUTORS"),x=new e.OlP("IDENTITY_CREATE_FORM_PROP_CONTRIBUTORS"),M=new e.OlP("IDENTITY_EDIT_FORM_PROP_CONTRIBUTORS");let R=(()=>{class i{constructor(t){this.injector=t}canActivate(){const t=this.injector.get(l.X6),n=this.injector.get(C,null)||{},s=this.injector.get(A,null)||{},a=this.injector.get(O,null)||{},d=this.injector.get(x,null)||{},b=this.injector.get(M,null)||{},f=this.injector.get(r.XJE);return(0,l.ot)(f,"Identity").pipe((0,z.U)(u=>({"Identity.RolesComponent":u.Role,"Identity.UsersComponent":u.User})),(0,l.V_)(f,"AbpIdentity"),(0,I.b)(u=>{(0,l.Fr)(t.entityActions,B,n),(0,l.Fr)(t.toolbarActions,w,s),(0,l.Hp)(t.entityProps,J,u.prop,a),(0,l.Hp)(t.createFormProps,j,u.createForm,d),(0,l.Hp)(t.editFormProps,Q,u.editForm,b)}),(0,V.h)(!0))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(e.zs3))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac}),i})();const qe=[{path:"",redirectTo:"roles",pathMatch:"full"},{path:"",component:r.O39,canActivate:[r.a1M,r.nG9,R],children:[{path:"roles",component:r.c$y,data:{requiredPolicy:"AbpIdentity.Roles",replaceableComponent:{key:"Identity.RolesComponent",defaultComponent:h}}},{path:"users",component:r.c$y,data:{requiredPolicy:"AbpIdentity.Users",replaceableComponent:{key:"Identity.UsersComponent",defaultComponent:g}}}]}];let Be=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[D.Bz.forChild(qe)],D.Bz]}),i})(),we=(()=>{class i{static forChild(t={}){return{ngModule:i,providers:[{provide:C,useValue:t.entityActionContributors},{provide:A,useValue:t.toolbarActionContributors},{provide:O,useValue:t.entityPropContributors},{provide:x,useValue:t.createFormPropContributors},{provide:M,useValue:t.editFormPropContributors},R]}}static forLazy(t={}){return new r.Cgl(i.forChild(t))}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[r.IR2,Be,_.Oz,m.e2,l.Ms,_.XC,ue,v.h2]]}),i})()}}]);